<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kilroy Was Here - Meme Generator</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef } = React;

        function KilroyMemeGenerator() {
            const [uploadedImage, setUploadedImage] = useState(null);
            const [name, setName] = useState('');
            const [memeGenerated, setMemeGenerated] = useState(false);
            const canvasRef = useRef(null);
            const fileInputRef = useRef(null);

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        setUploadedImage(event.target.result);
                        setMemeGenerated(false);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const drawKilroy = (ctx, centerX, y, scale = 1) => {
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';

                // Draw black outline first (shadow effect)
                ctx.strokeStyle = '#000';
                ctx.fillStyle = '#000';
                ctx.lineWidth = 5 * scale;

                // Head outline
                ctx.beginPath();
                ctx.arc(centerX, y - 40 * scale, 35 * scale, 0, Math.PI, true);
                ctx.stroke();

                // Eyes outline
                ctx.beginPath();
                ctx.arc(centerX - 15 * scale, y - 50 * scale, 4 * scale, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(centerX + 15 * scale, y - 50 * scale, 4 * scale, 0, Math.PI * 2);
                ctx.fill();

                // Nose outline
                ctx.beginPath();
                ctx.ellipse(centerX, y - 20 * scale, 12 * scale, 20 * scale, 0, 0, Math.PI * 2);
                ctx.stroke();

                // Hands outline - Left
                ctx.beginPath();
                ctx.moveTo(centerX - 80 * scale, y);
                ctx.lineTo(centerX - 70 * scale, y - 10 * scale);
                ctx.lineTo(centerX - 65 * scale, y);
                ctx.lineTo(centerX - 60 * scale, y - 8 * scale);
                ctx.lineTo(centerX - 55 * scale, y);
                ctx.lineTo(centerX - 50 * scale, y - 6 * scale);
                ctx.lineTo(centerX - 45 * scale, y);
                ctx.stroke();

                // Hands outline - Right
                ctx.beginPath();
                ctx.moveTo(centerX + 45 * scale, y);
                ctx.lineTo(centerX + 50 * scale, y - 6 * scale);
                ctx.lineTo(centerX + 55 * scale, y);
                ctx.lineTo(centerX + 60 * scale, y - 8 * scale);
                ctx.lineTo(centerX + 65 * scale, y);
                ctx.lineTo(centerX + 70 * scale, y - 10 * scale);
                ctx.lineTo(centerX + 80 * scale, y);
                ctx.stroke();

                // Now draw white Kilroy on top
                ctx.strokeStyle = '#fff';
                ctx.fillStyle = '#fff';
                ctx.lineWidth = 3 * scale;

                // Head (circle)
                ctx.beginPath();
                ctx.arc(centerX, y - 40 * scale, 35 * scale, 0, Math.PI, true);
                ctx.stroke();

                // Eyes
                ctx.beginPath();
                ctx.arc(centerX - 15 * scale, y - 50 * scale, 3 * scale, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(centerX + 15 * scale, y - 50 * scale, 3 * scale, 0, Math.PI * 2);
                ctx.fill();

                // Nose
                ctx.beginPath();
                ctx.ellipse(centerX, y - 20 * scale, 12 * scale, 20 * scale, 0, 0, Math.PI * 2);
                ctx.stroke();

                // Hands on wall - Left hand
                ctx.beginPath();
                ctx.moveTo(centerX - 80 * scale, y);
                ctx.lineTo(centerX - 70 * scale, y - 10 * scale);
                ctx.lineTo(centerX - 65 * scale, y);
                ctx.lineTo(centerX - 60 * scale, y - 8 * scale);
                ctx.lineTo(centerX - 55 * scale, y);
                ctx.lineTo(centerX - 50 * scale, y - 6 * scale);
                ctx.lineTo(centerX - 45 * scale, y);
                ctx.stroke();

                // Right hand
                ctx.beginPath();
                ctx.moveTo(centerX + 45 * scale, y);
                ctx.lineTo(centerX + 50 * scale, y - 6 * scale);
                ctx.lineTo(centerX + 55 * scale, y);
                ctx.lineTo(centerX + 60 * scale, y - 8 * scale);
                ctx.lineTo(centerX + 65 * scale, y);
                ctx.lineTo(centerX + 70 * scale, y - 10 * scale);
                ctx.lineTo(centerX + 80 * scale, y);
                ctx.stroke();
            };

            const generateMeme = () => {
                if (!uploadedImage || !name.trim()) return;

                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                const img = new Image();

                img.onload = () => {
                    canvas.width = img.width;
                    canvas.height = img.height;

                    ctx.drawImage(img, 0, 0);

                    const fontSize = Math.max(img.width / 15, 30);
                    const textY = img.height - fontSize * 1.5;
                    
                    const scale = Math.min(img.width / 300, img.height / 300);
                    const kilroyY = textY - fontSize * 1.5;
                    
                    drawKilroy(ctx, img.width / 2, kilroyY, scale);

                    // Draw horizontal line (wall) with black outline
                    ctx.strokeStyle = '#000';
                    ctx.lineWidth = 6 * scale;
                    ctx.beginPath();
                    ctx.moveTo(0, kilroyY);
                    ctx.lineTo(img.width, kilroyY);
                    ctx.stroke();
                    
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 4 * scale;
                    ctx.beginPath();
                    ctx.moveTo(0, kilroyY);
                    ctx.lineTo(img.width, kilroyY);
                    ctx.stroke();

                    ctx.font = `bold ${fontSize}px Arial`;
                    ctx.fillStyle = '#000';
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = fontSize / 10;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';

                    const text = `${name.toUpperCase()} WAS HERE`;

                    ctx.strokeText(text, img.width / 2, textY);
                    ctx.fillText(text, img.width / 2, textY);

                    setMemeGenerated(true);
                };

                img.src = uploadedImage;
            };

            const downloadMeme = () => {
                const canvas = canvasRef.current;
                const link = document.createElement('a');
                link.download = `${name.toLowerCase().replace(/\s+/g, '-')}-was-here.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            };

            const reset = () => {
                setUploadedImage(null);
                setName('');
                setMemeGenerated(false);
                if (fileInputRef.current) {
                    fileInputRef.current.value = '';
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-800 to-slate-900 p-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="text-center mb-8">
                            <h1 className="text-5xl font-bold text-white mb-2">Kilroy Was Here</h1>
                            <p className="text-slate-300 text-lg">Meme Generator</p>
                        </div>

                        <div className="bg-white rounded-lg shadow-2xl p-8 mb-6">
                            {!uploadedImage ? (
                                <div className="text-center">
                                    <input
                                        ref={fileInputRef}
                                        type="file"
                                        accept="image/*"
                                        onChange={handleImageUpload}
                                        className="hidden"
                                        id="image-upload"
                                    />
                                    <label
                                        htmlFor="image-upload"
                                        className="inline-flex items-center gap-2 px-8 py-4 bg-blue-600 text-white rounded-lg cursor-pointer hover:bg-blue-700 transition-colors text-lg font-semibold"
                                    >
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                            <polyline points="17 8 12 3 7 8"></polyline>
                                            <line x1="12" y1="3" x2="12" y2="15"></line>
                                        </svg>
                                        Upload Image
                                    </label>
                                    <p className="text-slate-500 mt-4">Choose an image to create your Kilroy meme</p>
                                </div>
                            ) : (
                                <div className="space-y-6">
                                    <div className="flex gap-4 items-end">
                                        <div className="flex-1">
                                            <label className="block text-sm font-medium text-slate-700 mb-2">
                                                Enter Name
                                            </label>
                                            <input
                                                type="text"
                                                value={name}
                                                onChange={(e) => setName(e.target.value)}
                                                placeholder="e.g., BOBBY"
                                                className="w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg"
                                            />
                                        </div>
                                        <button
                                            onClick={generateMeme}
                                            disabled={!name.trim()}
                                            className="px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors font-semibold"
                                        >
                                            Generate Meme
                                        </button>
                                    </div>

                                    <div className="border-2 border-slate-200 rounded-lg overflow-hidden">
                                        <canvas ref={canvasRef} className="w-full h-auto" />
                                    </div>

                                    <div className="flex gap-4">
                                        {memeGenerated && (
                                            <button
                                                onClick={downloadMeme}
                                                className="flex-1 inline-flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold"
                                            >
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                    <polyline points="7 10 12 15 17 10"></polyline>
                                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                                </svg>
                                                Download Meme
                                            </button>
                                        )}
                                        <button
                                            onClick={reset}
                                            className="flex-1 px-6 py-3 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors font-semibold"
                                        >
                                            New Image
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className="text-center text-slate-400 text-sm">
                            <p>Create unlimited "Kilroy was here" memes â€¢ Upload, name, download!</p>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<KilroyMemeGenerator />, document.getElementById('root'));
    </script>
</body>
</html>